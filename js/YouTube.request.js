class e{static name="Lodash";static version="1.2.2";static about(){return console.log(`\n🟧 ${this.name} v${this.version}\n`)}static get(e={},t="",a=void 0){Array.isArray(t)||(t=this.toPath(t));const n=t.reduce(((e,t)=>Object(e)[t]),e);return void 0===n?a:n}static set(e={},t="",a){return Array.isArray(t)||(t=this.toPath(t)),t.slice(0,-1).reduce(((e,a,n)=>Object(e[a])===e[a]?e[a]:e[a]=/^\d+$/.test(t[n+1])?[]:{}),e)[t[t.length-1]]=a,e}static unset(e={},t=""){return Array.isArray(t)||(t=this.toPath(t)),t.reduce(((e,a,n)=>n===t.length-1?(delete e[a],!0):Object(e)[a]),e)}static toPath(e){return e.replace(/\[(\d+)\]/g,".$1").split(".").filter(Boolean)}static escape(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(/[&<>"']/g,(e=>t[e]))}static unescape(e){const t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return e.replace(/&amp;|&lt;|&gt;|&quot;|&#39;/g,(e=>t[e]))}}class t{static name="$Storage";static version="1.0.9";static about(){return console.log(`\n🟧 ${this.name} v${this.version}\n`)}static data=null;static dataFile="box.dat";static#e=/^@(?<key>[^.]+)(?:\.(?<path>.*))?$/;static#t(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":"undefined"!=typeof Egern?"Egern":void 0}static getItem(t=new String,a=null){let n=a;if(!0===t.startsWith("@")){const{key:a,path:s}=t.match(this.#e)?.groups;t=a;let r=this.getItem(t,{});"object"!=typeof r&&(r={}),n=e.get(r,s);try{n=JSON.parse(n)}catch(e){}}else{switch(this.#t()){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":n=$persistentStore.read(t);break;case"Quantumult X":n=$prefs.valueForKey(t);break;case"Node.js":this.data=this.#a(this.dataFile),n=this.data?.[t];break;default:n=this.data?.[t]||null}try{n=JSON.parse(n)}catch(e){}}return n??a}static setItem(t=new String,a=new String){let n=!1;if("object"==typeof a)a=JSON.stringify(a);else a=String(a);if(!0===t.startsWith("@")){const{key:s,path:r}=t.match(this.#e)?.groups;t=s;let i=this.getItem(t,{});"object"!=typeof i&&(i={}),e.set(i,r,a),n=this.setItem(t,i)}else switch(this.#t()){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":n=$persistentStore.write(a,t);break;case"Quantumult X":n=$prefs.setValueForKey(a,t);break;case"Node.js":this.data=this.#a(this.dataFile),this.data[t]=a,this.#n(this.dataFile),n=!0;break;default:n=this.data?.[t]||null}return n}static removeItem(t){let a=!1;if(!0===t.startsWith("@")){const{key:n,path:s}=t.match(this.#e)?.groups;t=n;let r=this.getItem(t);"object"!=typeof r&&(r={}),keyValue=e.unset(r,s),a=this.setItem(t,r)}else switch(this.#t()){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Node.js":default:a=!1;break;case"Quantumult X":a=$prefs.removeValueForKey(t)}return a}static clear(){let e=!1;switch(this.#t()){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Node.js":default:e=!1;break;case"Quantumult X":e=$prefs.removeAllValues()}return e}static#a(e){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(e),a=this.path.resolve(process.cwd(),e),n=this.fs.existsSync(t),s=!n&&this.fs.existsSync(a);if(!n&&!s)return{};{const e=n?t:a;try{return JSON.parse(this.fs.readFileSync(e))}catch(e){return{}}}}}static#n(e=this.dataFile){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(e),a=this.path.resolve(process.cwd(),e),n=this.fs.existsSync(t),s=!n&&this.fs.existsSync(a),r=JSON.stringify(this.data);n?this.fs.writeFileSync(t,r):s?this.fs.writeFileSync(a,r):this.fs.writeFileSync(t,r)}}}class a{static name="ENV";static version="1.8.3";static about(){return console.log(`\n🟧 ${this.name} v${this.version}\n`)}constructor(e,t){console.log(`\n🟧 ${a.name} v${a.version}\n`),this.name=e,this.logs=[],this.isMute=!1,this.isMuteLog=!1,this.logSeparator="\n",this.encoding="utf-8",this.startTime=(new Date).getTime(),Object.assign(this,t),this.log(`\n🚩 开始!\n${e}\n`)}environment(){switch(this.platform()){case"Surge":return $environment.app="Surge",$environment;case"Stash":return $environment.app="Stash",$environment;case"Egern":return $environment.app="Egern",$environment;case"Loon":let e=$loon.split(" ");return{device:e[0],ios:e[1],"loon-version":e[2],app:"Loon"};case"Quantumult X":return{app:"Quantumult X"};case"Node.js":return process.env.app="Node.js",process.env;default:return{}}}platform(){return"undefined"!=typeof $environment&&$environment["surge-version"]?"Surge":"undefined"!=typeof $environment&&$environment["stash-version"]?"Stash":"undefined"!=typeof module&&module.exports?"Node.js":"undefined"!=typeof $task?"Quantumult X":"undefined"!=typeof $loon?"Loon":"undefined"!=typeof $rocket?"Shadowrocket":"undefined"!=typeof Egern?"Egern":void 0}isNode(){return"Node.js"===this.platform()}isQuanX(){return"Quantumult X"===this.platform()}isSurge(){return"Surge"===this.platform()}isLoon(){return"Loon"===this.platform()}isShadowrocket(){return"Shadowrocket"===this.platform()}isStash(){return"Stash"===this.platform()}isEgern(){return"Egern"===this.platform()}async getScript(e){return await this.fetch(e).then((e=>e.body))}async runScript(e,a){let n=t.getItem("@chavy_boxjs_userCfgs.httpapi");n=n?.replace?.(/\n/g,"")?.trim();let s=t.getItem("@chavy_boxjs_userCfgs.httpapi_timeout");s=1*s??20,s=a?.timeout??s;const[r,i]=n.split("@"),o={url:`http://${i}/v1/scripting/evaluate`,body:{script_text:e,mock_type:"cron",timeout:s},headers:{"X-Key":r,Accept:"*/*"},timeout:s};await this.fetch(o).then((e=>e.body),(e=>this.logErr(e)))}initGotEnv(e){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,e&&(e.headers=e.headers?e.headers:{},void 0===e.headers.Cookie&&void 0===e.cookieJar&&(e.cookieJar=this.ckjar))}async fetch(t={}||"",a={}){switch(t.constructor){case Object:t={...a,...t};break;case String:t={...a,url:t}}t.method||(t.method="GET",(t.body??t.bodyBytes)&&(t.method="POST")),delete t.headers?.Host,delete t.headers?.[":authority"],delete t.headers?.["Content-Length"],delete t.headers?.["content-length"];const n=t.method.toLocaleLowerCase();switch(this.platform()){case"Loon":case"Surge":case"Stash":case"Egern":case"Shadowrocket":default:return t.timeout&&(t.timeout=parseInt(t.timeout,10),this.isSurge()||(t.timeout=1e3*t.timeout)),t.policy&&(this.isLoon()&&(t.node=t.policy),this.isStash()&&e.set(t,"headers.X-Stash-Selected-Proxy",encodeURI(t.policy)),this.isShadowrocket()&&e.set(t,"headers.X-Surge-Proxy",t.policy)),"boolean"==typeof t.redirection&&(t["auto-redirect"]=t.redirection),t.bodyBytes&&!t.body&&(t.body=t.bodyBytes,delete t.bodyBytes),await new Promise(((e,a)=>{$httpClient[n](t,((n,s,r)=>{n?a(n):(s.ok=/^2\d\d$/.test(s.status),s.statusCode=s.status,r&&(s.body=r,1==t["binary-mode"]&&(s.bodyBytes=r)),e(s))}))}));case"Quantumult X":return t.policy&&e.set(t,"opts.policy",t.policy),"boolean"==typeof t["auto-redirect"]&&e.set(t,"opts.redirection",t["auto-redirect"]),t.body instanceof ArrayBuffer?(t.bodyBytes=t.body,delete t.body):ArrayBuffer.isView(t.body)?(t.bodyBytes=t.body.buffer.slice(t.body.byteOffset,t.body.byteLength+t.body.byteOffset),delete object.body):t.body&&delete t.bodyBytes,await $task.fetch(t).then((e=>(e.ok=/^2\d\d$/.test(e.statusCode),e.status=e.statusCode,e)),(e=>Promise.reject(e.error)));case"Node.js":let a=require("iconv-lite");this.initGotEnv(t);const{url:s,...r}=t;return await this.got[n](s,r).on("redirect",((e,t)=>{try{if(e.headers["set-cookie"]){const a=e.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();a&&this.ckjar.setCookieSync(a,null),t.cookieJar=this.ckjar}}catch(e){this.logErr(e)}})).then((e=>(e.statusCode=e.status,e.body=a.decode(e.rawBody,this.encoding),e.bodyBytes=e.rawBody,e)),(e=>Promise.reject(e.message)))}}time(e,t=null){const a=t?new Date(t):new Date;let n={"M+":a.getMonth()+1,"d+":a.getDate(),"H+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(let t in n)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[t]:("00"+n[t]).substr((""+n[t]).length)));return e}msg(e=name,t="",a="",n){const s=e=>{switch(typeof e){case void 0:return e;case"string":switch(this.platform()){case"Surge":case"Stash":case"Egern":default:return{url:e};case"Loon":case"Shadowrocket":return e;case"Quantumult X":return{"open-url":e};case"Node.js":return}case"object":switch(this.platform()){case"Surge":case"Stash":case"Egern":case"Shadowrocket":default:return{url:e.url||e.openUrl||e["open-url"]};case"Loon":return{openUrl:e.openUrl||e.url||e["open-url"],mediaUrl:e.mediaUrl||e["media-url"]};case"Quantumult X":return{"open-url":e["open-url"]||e.url||e.openUrl,"media-url":e["media-url"]||e.mediaUrl,"update-pasteboard":e["update-pasteboard"]||e.updatePasteboard};case"Node.js":return}default:return}};if(!this.isMute)switch(this.platform()){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":default:$notification.post(e,t,a,s(n));break;case"Quantumult X":$notify(e,t,a,s(n));case"Node.js":}if(!this.isMuteLog){let n=["","==============📣系统通知📣=============="];n.push(e),t&&n.push(t),a&&n.push(a),console.log(n.join("\n")),this.logs=this.logs.concat(n)}}log(...e){e.length>0&&(this.logs=[...this.logs,...e]),console.log(e.join(this.logSeparator))}logErr(e){switch(this.platform()){case"Surge":case"Loon":case"Stash":case"Egern":case"Shadowrocket":case"Quantumult X":default:this.log("",`❗️ ${this.name}, 错误!`,e);break;case"Node.js":this.log("",`❗️${this.name}, 错误!`,e.stack)}}wait(e){return new Promise((t=>setTimeout(t,e)))}done(t={}){const a=((new Date).getTime()-this.startTime)/1e3;switch(this.log("",`🚩 ${this.name}, 结束! 🕛 ${a} 秒`,""),this.platform()){case"Surge":t.policy&&e.set(t,"headers.X-Surge-Policy",t.policy),$done(t);break;case"Loon":t.policy&&(t.node=t.policy),$done(t);break;case"Stash":t.policy&&e.set(t,"headers.X-Stash-Selected-Proxy",encodeURI(t.policy)),$done(t);break;case"Egern":case"Shadowrocket":default:$done(t);break;case"Quantumult X":t.policy&&e.set(t,"opts.policy",t.policy),delete t["auto-redirect"],delete t["auto-cookie"],delete t["binary-mode"],delete t.charset,delete t.host,delete t.insecure,delete t.method,delete t.opt,delete t.path,delete t.policy,delete t["policy-descriptor"],delete t.scheme,delete t.sessionIndex,delete t.statusCode,delete t.timeout,t.body instanceof ArrayBuffer?(t.bodyBytes=t.body,delete t.body):ArrayBuffer.isView(t.body)?(t.bodyBytes=t.body.buffer.slice(t.body.byteOffset,t.body.byteLength+t.body.byteOffset),delete t.body):t.body&&delete t.bodyBytes,$done(t);break;case"Node.js":process.exit(1)}}}var n={Switch:!0,Type:"Translate",Types:["Official","Translate"],Languages:["EN","ZH"],CacheSize:50},s={breakLine:{"text/xml":"&#x000A;","application/xml":"&#x000A;","text/vtt":"\n","application/vtt":"\n","text/json":"\n","application/json":"\n"}},r={Settings:n,Configs:s},i={Switch:!0,Type:"Official",Types:["Translate","External"],Languages:["AUTO","ZH"],AutoCC:!0,ShowOnly:!1},o={Languages:{BG:"bg-BG",CS:"cs",DA:"da-DK",DE:"de",EL:"el",EN:"en","EN-GB":"en-GB","EN-US":"en-US","EN-US SDH":"en-US SDH",ES:"es","ES-419":"es-419","ES-ES":"es-ES",ET:"et-EE",FI:"fi",FR:"fr",HU:"hu-HU",ID:"id",IS:"is-IS",IT:"it",JA:"ja",KO:"ko",LT:"lt-LT",LV:"lv-LV",NL:"nl-NL",NO:"nb-NO",PL:"pl-PL",PT:"pt","PT-PT":"pt-PT","PT-BR":"pt-BR",RO:"ro-RO",RU:"ru-RU",SK:"sk-SK",SL:"sl-SI",SV:"sv-SE",YUE:"yue","YUE-HK":"yue-HK",ZH:"zh","ZH-HANS":"zh-Hans","ZH-HK":"zh-Hant-HK","ZH-HANT":"zh-Hant","ZH-TW":"zh-TW"},translationLanguages:{DESKTOP:[{languageCode:"sq",languageName:{simpleText:"Shqip - 阿尔巴尼亚语"}},{languageCode:"ak",languageName:{simpleText:"Ákán - 阿肯语"}},{languageCode:"ar",languageName:{simpleText:"العربية - 阿拉伯语"}},{languageCode:"am",languageName:{simpleText:"አማርኛ - 阿姆哈拉语"}},{languageCode:"as",languageName:{simpleText:"অসমীয়া - 阿萨姆语"}},{languageCode:"az",languageName:{simpleText:"آذربايجان ديلی - 阿塞拜疆语"}},{languageCode:"ee",languageName:{simpleText:"Èʋegbe - 埃维语"}},{languageCode:"ay",languageName:{simpleText:"Aymar aru - 艾马拉语"}},{languageCode:"ga",languageName:{simpleText:"Gaeilge - 爱尔兰语"}},{languageCode:"et",languageName:{simpleText:"Eesti - 爱沙尼亚语"}},{languageCode:"or",languageName:{simpleText:"ଓଡ଼ିଆ - 奥里亚语"}},{languageCode:"om",languageName:{simpleText:"Afaan Oromoo - 奥罗莫语"}},{languageCode:"eu",languageName:{simpleText:"Euskara - 巴斯克语"}},{languageCode:"be",languageName:{simpleText:"Беларуская - 白俄罗斯语"}},{languageCode:"bg",languageName:{simpleText:"Български - 保加利亚语"}},{languageCode:"nso",languageName:{simpleText:"Sesotho sa Leboa - 北索托语"}},{languageCode:"is",languageName:{simpleText:"Íslenska - 冰岛语"}},{languageCode:"pl",languageName:{simpleText:"Polski - 波兰语"}},{languageCode:"bs",languageName:{simpleText:"Bosanski - 波斯尼亚语"}},{languageCode:"fa",languageName:{simpleText:"فارسی - 波斯语"}},{languageCode:"bho",languageName:{simpleText:"भोजपुरी - 博杰普尔语"}},{languageCode:"ts",languageName:{simpleText:"Xitsonga - 聪加语"}},{languageCode:"tt",languageName:{simpleText:"Татарча - 鞑靼语"}},{languageCode:"da",languageName:{simpleText:"Dansk - 丹麦语"}},{languageCode:"de",languageName:{simpleText:"Deutsch - 德语"}},{languageCode:"dv",languageName:{simpleText:"ދިވެހިބަސް - 迪维希语"}},{languageCode:"ru",languageName:{simpleText:"Русский - 俄语"}},{languageCode:"fr",languageName:{simpleText:"français - 法语"}},{languageCode:"sa",languageName:{simpleText:"संस्कृतम् - 梵语"}},{languageCode:"fil",languageName:{simpleText:"Filipino - 菲律宾语"}},{languageCode:"fi",languageName:{simpleText:"suomi - 芬兰语"}},{languageCode:"km",languageName:{simpleText:"ភាសាខ្មែរ - 高棉语"}},{languageCode:"ka",languageName:{simpleText:"ქართული - 格鲁吉亚语"}},{languageCode:"gu",languageName:{simpleText:"ગુજરાતી - 古吉拉特语"}},{languageCode:"gn",languageName:{simpleText:"Avañe'ẽ - 瓜拉尼语"}},{languageCode:"kk",languageName:{simpleText:"Қазақ тілі - 哈萨克语"}},{languageCode:"ht",languageName:{simpleText:"Kreyòl ayisyen - 海地克里奥尔语"}},{languageCode:"ko",languageName:{simpleText:"한국어 - 韩语"}},{languageCode:"ha",languageName:{simpleText:"هَوُسَ - 豪萨语"}},{languageCode:"nl",languageName:{simpleText:"Nederlands - 荷兰语"}},{languageCode:"gl",languageName:{simpleText:"Galego - 加利西亚语"}},{languageCode:"ca",languageName:{simpleText:"català - 加泰罗尼亚语"}},{languageCode:"cs",languageName:{simpleText:"čeština - 捷克语"}},{languageCode:"kn",languageName:{simpleText:"ಕನ್ನಡ - 卡纳达语"}},{languageCode:"ky",languageName:{simpleText:"кыргыз тили - 吉尔吉斯语"}},{languageCode:"xh",languageName:{simpleText:"isiXhosa - 科萨语"}},{languageCode:"co",languageName:{simpleText:"corsu - 科西嘉语"}},{languageCode:"hr",languageName:{simpleText:"hrvatski - 克罗地亚语"}},{languageCode:"qu",languageName:{simpleText:"Runa Simi - 克丘亚语"}},{languageCode:"ku",languageName:{simpleText:"Kurdî - 库尔德语"}},{languageCode:"la",languageName:{simpleText:"lingua latīna - 拉丁语"}},{languageCode:"lv",languageName:{simpleText:"latviešu valoda - 拉脱维亚语"}},{languageCode:"lo",languageName:{simpleText:"ພາສາລາວ - 老挝语"}},{languageCode:"lt",languageName:{simpleText:"lietuvių kalba - 立陶宛语"}},{languageCode:"ln",languageName:{simpleText:"lingála - 林加拉语"}},{languageCode:"lg",languageName:{simpleText:"Luganda - 卢干达语"}},{languageCode:"lb",languageName:{simpleText:"Lëtzebuergesch - 卢森堡语"}},{languageCode:"rw",languageName:{simpleText:"Kinyarwanda - 卢旺达语"}},{languageCode:"ro",languageName:{simpleText:"Română - 罗马尼亚语"}},{languageCode:"mt",languageName:{simpleText:"Malti - 马耳他语"}},{languageCode:"mr",languageName:{simpleText:"मराठी - 马拉地语"}},{languageCode:"mg",languageName:{simpleText:"Malagasy - 马拉加斯语"}},{languageCode:"ml",languageName:{simpleText:"മലയാളം - 马拉雅拉姆语"}},{languageCode:"ms",languageName:{simpleText:"bahasa Melayu - 马来语"}},{languageCode:"mk",languageName:{simpleText:"македонски јазик - 马其顿语"}},{languageCode:"mi",languageName:{simpleText:"te reo Māori - 毛利语"}},{languageCode:"mn",languageName:{simpleText:"Монгол хэл - 蒙古语"}},{languageCode:"bn",languageName:{simpleText:"বাংলা - 孟加拉语"}},{languageCode:"my",languageName:{simpleText:"ဗမာစာ - 缅甸语"}},{languageCode:"hmn",languageName:{simpleText:"Hmoob - 苗语"}},{languageCode:"af",languageName:{simpleText:"Afrikaans - 南非荷兰语"}},{languageCode:"st",languageName:{simpleText:"Sesotho - 南索托语"}},{languageCode:"ne",languageName:{simpleText:"नेपाली - 尼泊尔语"}},{languageCode:"no",languageName:{simpleText:"Norsk - 挪威语"}},{languageCode:"pa",languageName:{simpleText:"ਪੰਜਾਬੀ - 旁遮普语"}},{languageCode:"pt",languageName:{simpleText:"Português - 葡萄牙语"}},{languageCode:"ps",languageName:{simpleText:"پښتو - 普什图语"}},{languageCode:"ny",languageName:{simpleText:"chiCheŵa - 齐切瓦语"}},{languageCode:"ja",languageName:{simpleText:"日本語 - 日语"}},{languageCode:"sv",languageName:{simpleText:"Svenska - 瑞典语"}},{languageCode:"sm",languageName:{simpleText:"Gagana fa'a Samoa - 萨摩亚语"}},{languageCode:"sr",languageName:{simpleText:"Српски језик - 塞尔维亚语"}},{languageCode:"si",languageName:{simpleText:"සිංහල - 僧伽罗语"}},{languageCode:"sn",languageName:{simpleText:"ChiShona - 绍纳语"}},{languageCode:"eo",languageName:{simpleText:"Esperanto - 世界语"}},{languageCode:"sk",languageName:{simpleText:"slovenčina - 斯洛伐克语"}},{languageCode:"sl",languageName:{simpleText:"slovenščina - 斯洛文尼亚语"}},{languageCode:"sw",languageName:{simpleText:"Kiswahili - 斯瓦希里语"}},{languageCode:"gd",languageName:{simpleText:"Gàidhlig - 苏格兰盖尔语"}},{languageCode:"ceb",languageName:{simpleText:"Binisaya - 宿务语"}},{languageCode:"so",languageName:{simpleText:"Soomaaliga - 索马里语"}},{languageCode:"tg",languageName:{simpleText:"тоҷикӣ - 塔吉克语"}},{languageCode:"te",languageName:{simpleText:"తెలుగు - 泰卢固语"}},{languageCode:"ta",languageName:{simpleText:"தமிழ் - 泰米尔语"}},{languageCode:"th",languageName:{simpleText:"ไทย - 泰语"}},{languageCode:"ti",languageName:{simpleText:"ትግርኛ - 提格利尼亚语"}},{languageCode:"tr",languageName:{simpleText:"Türkçe - 土耳其语"}},{languageCode:"tk",languageName:{simpleText:"Türkmen - 土库曼语"}},{languageCode:"cy",languageName:{simpleText:"Cymraeg - 威尔士语"}},{languageCode:"ug",languageName:{simpleText:"ئۇيغۇرچە - 维吾尔语"}},{languageCode:"und",languageName:{simpleText:"Unknown - 未知语言"}},{languageCode:"ur",languageName:{simpleText:"اردو - 乌尔都语"}},{languageCode:"uk",languageName:{simpleText:"українська - 乌克兰语"}},{languageCode:"uz",languageName:{simpleText:"O'zbek - 乌兹别克语"}},{languageCode:"es",languageName:{simpleText:"Español - 西班牙语"}},{languageCode:"fy",languageName:{simpleText:"Frysk - 西弗里西亚语"}},{languageCode:"iw",languageName:{simpleText:"עברית - 希伯来语"}},{languageCode:"el",languageName:{simpleText:"Ελληνικά - 希腊语"}},{languageCode:"haw",languageName:{simpleText:"ʻŌlelo Hawaiʻi - 夏威夷语"}},{languageCode:"sd",languageName:{simpleText:"سنڌي - 信德语"}},{languageCode:"hu",languageName:{simpleText:"magyar - 匈牙利语"}},{languageCode:"su",languageName:{simpleText:"Basa Sunda - 巽他语"}},{languageCode:"hy",languageName:{simpleText:"հայերեն - 亚美尼亚语"}},{languageCode:"ig",languageName:{simpleText:"Igbo - 伊博语"}},{languageCode:"it",languageName:{simpleText:"Italiano - 意大利语"}},{languageCode:"yi",languageName:{simpleText:"ייִדיש - 意第绪语"}},{languageCode:"hi",languageName:{simpleText:"हिन्दी - 印地语"}},{languageCode:"id",languageName:{simpleText:"Bahasa Indonesia - 印度尼西亚语"}},{languageCode:"en",languageName:{simpleText:"English - 英语"}},{languageCode:"yo",languageName:{simpleText:"Yorùbá - 约鲁巴语"}},{languageCode:"vi",languageName:{simpleText:"Tiếng Việt - 越南语"}},{languageCode:"jv",languageName:{simpleText:"Basa Jawa - 爪哇语"}},{languageCode:"zh-Hant",languageName:{simpleText:"中文（繁體）- 中文（繁体）"}},{languageCode:"zh-Hans",languageName:{simpleText:"中文（简体）"}},{languageCode:"zu",languageName:{simpleText:"isiZulu - 祖鲁语"}},{languageCode:"kri",languageName:{simpleText:"Krìì - 克里语"}}],MOBILE:[{languageCode:"sq",languageName:{runs:[{text:"Shqip - 阿尔巴尼亚语"}]}},{languageCode:"ak",languageName:{runs:[{text:"Ákán - 阿肯语"}]}},{languageCode:"ar",languageName:{runs:[{text:"العربية - 阿拉伯语"}]}},{languageCode:"am",languageName:{runs:[{text:"አማርኛ - 阿姆哈拉语"}]}},{languageCode:"as",languageName:{runs:[{text:"অসমীয়া - 阿萨姆语"}]}},{languageCode:"az",languageName:{runs:[{text:"Azərbaycanca - 阿塞拜疆语"}]}},{languageCode:"ee",languageName:{runs:[{text:"Eʋegbe - 埃维语"}]}},{languageCode:"ay",languageName:{runs:[{text:"Aymar - 艾马拉语"}]}},{languageCode:"ga",languageName:{runs:[{text:"Gaeilge - 爱尔兰语"}]}},{languageCode:"et",languageName:{runs:[{text:"Eesti - 爱沙尼亚语"}]}},{languageCode:"or",languageName:{runs:[{text:"ଓଡ଼ିଆ - 奥里亚语"}]}},{languageCode:"om",languageName:{runs:[{text:"Oromoo - 奥罗莫语"}]}},{languageCode:"eu",languageName:{runs:[{text:"Euskara - 巴斯克语"}]}},{languageCode:"be",languageName:{runs:[{text:"Беларуская - 白俄罗斯语"}]}},{languageCode:"bg",languageName:{runs:[{text:"Български - 保加利亚语"}]}},{languageCode:"nso",languageName:{runs:[{text:"Sesotho sa Leboa - 北索托语"}]}},{languageCode:"is",languageName:{runs:[{text:"Íslenska - 冰岛语"}]}},{languageCode:"pl",languageName:{runs:[{text:"Polski - 波兰语"}]}},{languageCode:"bs",languageName:{runs:[{text:"Bosanski - 波斯尼亚语"}]}},{languageCode:"fa",languageName:{runs:[{text:"فارسی - 波斯语"}]}},{languageCode:"bho",languageName:{runs:[{text:"भोजपुरी - 博杰普尔语"}]}},{languageCode:"ts",languageName:{runs:[{text:"Xitsonga - 聪加语"}]}},{languageCode:"tt",languageName:{runs:[{text:"Татарча - 鞑靼语"}]}},{languageCode:"da",languageName:{runs:[{text:"Dansk - 丹麦语"}]}},{languageCode:"de",languageName:{runs:[{text:"Deutsch - 德语"}]}},{languageCode:"dv",languageName:{runs:[{text:"ދިވެހިބަސް - 迪维希语"}]}},{languageCode:"ru",languageName:{runs:[{text:"Русский - 俄语"}]}},{languageCode:"fr",languageName:{runs:[{text:"Français - 法语"}]}},{languageCode:"sa",languageName:{runs:[{text:"संस्कृतम् - 梵语"}]}},{languageCode:"fil",languageName:{runs:[{text:"Filipino - 菲律宾语"}]}},{languageCode:"fi",languageName:{runs:[{text:"Suomi - 芬兰语"}]}},{languageCode:"km",languageName:{runs:[{text:"ភាសាខ្មែរ - 高棉语"}]}},{languageCode:"ka",languageName:{runs:[{text:"ქართული - 格鲁吉亚语"}]}},{languageCode:"gu",languageName:{runs:[{text:"ગુજરાતી - 古吉拉特语"}]}},{languageCode:"gn",languageName:{runs:[{text:"Avañe'ẽ - 瓜拉尼语"}]}},{languageCode:"kk",languageName:{runs:[{text:"Қазақ тілі - 哈萨克语"}]}},{languageCode:"ht",languageName:{runs:[{text:"海地克里奥尔语"}]}},{languageCode:"ko",languageName:{runs:[{text:"한국말 - 韩语"}]}},{languageCode:"ha",languageName:{runs:[{text:"هَوُسَ - 豪萨语"}]}},{languageCode:"nl",languageName:{runs:[{text:"Nederlands - 荷兰语"}]}},{languageCode:"gl",languageName:{runs:[{text:"Galego - 加利西亚语"}]}},{languageCode:"ca",languageName:{runs:[{text:"Català - 加泰罗尼亚语"}]}},{languageCode:"cs",languageName:{runs:[{text:"Čeština - 捷克语"}]}},{languageCode:"kn",languageName:{runs:[{text:"ಕನ್ನಡ - 卡纳达语"}]}},{languageCode:"ky",languageName:{runs:[{text:"Кыргызча - 吉尔吉斯语"}]}},{languageCode:"xh",languageName:{runs:[{text:"isiXhosa - 科萨语"}]}},{languageCode:"co",languageName:{runs:[{text:"Corsu - 科西嘉语"}]}},{languageCode:"hr",languageName:{runs:[{text:"Hrvatski - 克罗地亚语"}]}},{languageCode:"qu",languageName:{runs:[{text:"Runa Simi - 克丘亚语"}]}},{languageCode:"ku",languageName:{runs:[{text:"Kurdî - 库尔德语"}]}},{languageCode:"la",languageName:{runs:[{text:"lingua latīna - 拉丁语"}]}},{languageCode:"lv",languageName:{runs:[{text:"Latviešu - 拉脱维亚语"}]}},{languageCode:"lo",languageName:{runs:[{text:"ລາວ - 老挝语"}]}},{languageCode:"lt",languageName:{runs:[{text:"Lietuvių - 立陶宛语"}]}},{languageCode:"ln",languageName:{runs:[{text:"Lingála - 林加拉语"}]}},{languageCode:"lg",languageName:{runs:[{text:"Luganda - 卢干达语"}]}},{languageCode:"lb",languageName:{runs:[{text:"Lëtzebuergesch - 卢森堡语"}]}},{languageCode:"rw",languageName:{runs:[{text:"Kinyarwanda - 卢旺达语"}]}},{languageCode:"ro",languageName:{runs:[{text:"Română - 罗马尼亚语"}]}},{languageCode:"mt",languageName:{runs:[{text:"Malti - 马耳他语"}]}},{languageCode:"mr",languageName:{runs:[{text:"मराठी - 马拉地语"}]}},{languageCode:"mg",languageName:{runs:[{text:"Malagasy - 马拉加斯语"}]}},{languageCode:"ml",languageName:{runs:[{text:"മലയാളം - 马拉雅拉姆语"}]}},{languageCode:"ms",languageName:{runs:[{text:"Bahasa Melayu - 马来语"}]}},{languageCode:"mk",languageName:{runs:[{text:"македонски - 马其顿语"}]}},{languageCode:"mi",languageName:{runs:[{text:"Māori - 毛利语"}]}},{languageCode:"mn",languageName:{runs:[{text:"Монгол - 蒙古语"}]}},{languageCode:"bn",languageName:{runs:[{text:"বাংলা - 孟加拉语"}]}},{languageCode:"my",languageName:{runs:[{text:"ဗမာစာ - 缅甸语"}]}},{languageCode:"hmn",languageName:{runs:[{text:"Hmoob - 苗语"}]}},{languageCode:"af",languageName:{runs:[{text:"Afrikaans - 南非荷兰语"}]}},{languageCode:"st",languageName:{runs:[{text:"Sesotho - 南索托语"}]}},{languageCode:"ne",languageName:{runs:[{text:"नेपाली - 尼泊尔语"}]}},{languageCode:"no",languageName:{runs:[{text:"Norsk - 挪威语"}]}},{languageCode:"pa",languageName:{runs:[{text:"ਪੰਜਾਬੀ - 旁遮普语"}]}},{languageCode:"pt",languageName:{runs:[{text:"Português - 葡萄牙语"}]}},{languageCode:"ps",languageName:{runs:[{text:"پښتو - 普什图语"}]}},{languageCode:"ny",languageName:{runs:[{text:"chiCheŵa - 齐切瓦语"}]}},{languageCode:"ja",languageName:{runs:[{text:"日本語 - 日语"}]}},{languageCode:"sv",languageName:{runs:[{text:"Svenska - 瑞典语"}]}},{languageCode:"sm",languageName:{runs:[{text:"Gagana Samoa - 萨摩亚语"}]}},{languageCode:"sr",languageName:{runs:[{text:"Српски језик - 塞尔维亚语"}]}},{languageCode:"si",languageName:{runs:[{text:"සිංහල - 僧伽罗语"}]}},{languageCode:"sn",languageName:{runs:[{text:"ChiShona - 绍纳语"}]}},{languageCode:"eo",languageName:{runs:[{text:"Esperanto - 世界语"}]}},{languageCode:"sk",languageName:{runs:[{text:"Slovenčina - 斯洛伐克语"}]}},{languageCode:"sl",languageName:{runs:[{text:"Slovenščina - 斯洛文尼亚语"}]}},{languageCode:"sw",languageName:{runs:[{text:"Kiswahili - 斯瓦希里语"}]}},{languageCode:"gd",languageName:{runs:[{text:"Gàidhlig - 苏格兰盖尔语"}]}},{languageCode:"ceb",languageName:{runs:[{text:"Cebuano - 宿务语"}]}},{languageCode:"so",languageName:{runs:[{text:"Soomaaliga - 索马里语"}]}},{languageCode:"tg",languageName:{runs:[{text:"тоҷикӣ - 塔吉克语"}]}},{languageCode:"te",languageName:{runs:[{text:"తెలుగు - 泰卢固语"}]}},{languageCode:"ta",languageName:{runs:[{text:"தமிழ் - 泰米尔语"}]}},{languageCode:"th",languageName:{runs:[{text:"ไทย - 泰语"}]}},{languageCode:"ti",languageName:{runs:[{text:"ትግርኛ - 提格利尼亚语"}]}},{languageCode:"tr",languageName:{runs:[{text:"Türkçe - 土耳其语"}]}},{languageCode:"tk",languageName:{runs:[{text:"Türkmen - 土库曼语"}]}},{languageCode:"cy",languageName:{runs:[{text:"Cymraeg - 威尔士语"}]}},{languageCode:"ug",languageName:{runs:[{text:"ئۇيغۇرچە - 维吾尔语"}]}},{languageCode:"und",languageName:{runs:[{text:"Unknown - 未知语言"}]}},{languageCode:"ur",languageName:{runs:[{text:"اردو - 乌尔都语"}]}},{languageCode:"uk",languageName:{runs:[{text:"Українська - 乌克兰语"}]}},{languageCode:"uz",languageName:{runs:[{text:"O‘zbek - 乌兹别克语"}]}},{languageCode:"es",languageName:{runs:[{text:"Español - 西班牙语"}]}},{languageCode:"fy",languageName:{runs:[{text:"Frysk - 西弗里西亚语"}]}},{languageCode:"iw",languageName:{runs:[{text:"עברית - 希伯来语"}]}},{languageCode:"el",languageName:{runs:[{text:"Ελληνικά - 希腊语"}]}},{languageCode:"haw",languageName:{runs:[{text:"ʻŌlelo Hawaiʻi - 夏威夷语"}]}},{languageCode:"sd",languageName:{runs:[{text:"سنڌي - 信德语"}]}},{languageCode:"hu",languageName:{runs:[{text:"Magyar - 匈牙利语"}]}},{languageCode:"su",languageName:{runs:[{text:"Basa Sunda - 巽他语"}]}},{languageCode:"hy",languageName:{runs:[{text:"Հայերեն - 亚美尼亚语"}]}},{languageCode:"ig",languageName:{runs:[{text:"Igbo - 伊博语"}]}},{languageCode:"it",languageName:{runs:[{text:"Italiano - 意大利语"}]}},{languageCode:"yi",languageName:{runs:[{text:"ייִדיש - 意第绪语"}]}},{languageCode:"hi",languageName:{runs:[{text:"हिन्दी - 印地语"}]}},{languageCode:"id",languageName:{runs:[{text:"Bahasa Indonesia - 印度尼西亚语"}]}},{languageCode:"en",languageName:{runs:[{text:"English - 英语"}]}},{languageCode:"yo",languageName:{runs:[{text:"Yorùbá - 约鲁巴语"}]}},{languageCode:"vi",languageName:{runs:[{text:"Tiếng Việt - 越南语"}]}},{languageCode:"jv",languageName:{runs:[{text:"Basa Jawa - 爪哇语"}]}},{languageCode:"zh-Hant",languageName:{runs:[{text:"中文（繁體） - 中文（繁体）"}]}},{languageCode:"zh-Hans",languageName:{runs:[{text:"中文（简体）"}]}},{languageCode:"zu",languageName:{runs:[{text:"isiZulu - 祖鲁语"}]}},{languageCode:"kri",languageName:{runs:[{text:"Krìì - 克里语"}]}}]}},l={Settings:i,Configs:o},u=Database={Default:Object.freeze({__proto__:null,Configs:s,Settings:n,default:r}),YouTube:Object.freeze({__proto__:null,Configs:o,Settings:i,default:l})};function g(a,n,s){console.log("☑️ Set Environment Variables","");let{Settings:r,Caches:i,Configs:o}=function(a,n,s){let r=t.getItem(a,s),i={};if("undefined"!=typeof $argument&&Boolean($argument)){let t=Object.fromEntries($argument.split("&").map((e=>e.split("=").map((e=>e.replace(/\"/g,""))))));for(let a in t)e.set(i,a,t[a])}const o={Settings:s?.Default?.Settings||{},Configs:s?.Default?.Configs||{},Caches:{}};Array.isArray(n)||(n=[n]);for(let e of n)o.Settings={...o.Settings,...s?.[e]?.Settings,...i,...r?.[e]?.Settings},o.Configs={...o.Configs,...s?.[e]?.Configs},r?.[e]?.Caches&&"string"==typeof r?.[e]?.Caches&&(r[e].Caches=JSON.parse(r?.[e]?.Caches)),o.Caches={...o.Caches,...r?.[e]?.Caches};return function e(t,a){for(var n in t){var s=t[n];t[n]="object"==typeof s&&null!==s?e(s,a):a(n,s)}return t}(o.Settings,((e,t)=>("true"===t||"false"===t?t=JSON.parse(t):"string"==typeof t&&(t=t.includes(",")?t.split(",").map((e=>l(e))):l(t)),t))),o;function l(e){return e&&!isNaN(e)&&(e=parseInt(e,10)),e}}(a,n,s);if(Array.isArray(r?.Types)||(r.Types=r.Types?[r.Types]:[]),n.includes("YouTube")){switch(r.AutoCC=t.getItem("自动显示翻译字幕")??r.AutoCC,r.AutoCC){case"是":r.AutoCC=!0;break;case"否":r.AutoCC=!1}switch(r.ShowOnly=t.getItem("仅输出字幕译文")??r.ShowOnly,r.ShowOnly){case"是":r.ShowOnly=!0;break;case"否":r.ShowOnly=!1}switch(r.Position=t.getItem("字幕译文的位置")??r.Position,r.Position){case"译文位于原文之上":r.Position="Forward";break;case"译文位于原文之下":r.Position="Reverse"}}return console.log(`✅ Set Environment Variables, Settings: ${typeof r}, Settings内容: ${JSON.stringify(r)}`,""),("object"!=typeof i?.Playlists||Array.isArray(i?.Playlists))&&(i.Playlists={}),i.Playlists.Master=new Map(JSON.parse(i?.Playlists?.Master||"[]")),i.Playlists.Subtitle=new Map(JSON.parse(i?.Playlists?.Subtitle||"[]")),"object"!=typeof i?.Subtitles&&(i.Subtitles=new Map(JSON.parse(i?.Subtitles||"[]"))),("object"!=typeof i?.Metadatas||Array.isArray(i?.Metadatas))&&(i.Metadatas={}),"object"!=typeof i?.Metadatas?.Tracks&&(i.Metadatas.Tracks=new Map(JSON.parse(i?.Metadatas?.Tracks||"[]"))),{Settings:r,Caches:i,Configs:o}}function c(e){let t=typeof e;if("object"==t){if(Array.isArray(e))return"array";if(null===e)return"null"}return t}let h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),d=[];for(let e=0;e<h.length;e++)d[h[e].charCodeAt(0)]=e;var m,f;function p(){let e=0,t=0;for(let a=0;a<28;a+=7){let n=this.buf[this.pos++];if(e|=(127&n)<<a,0==(128&n))return this.assertBounds(),[e,t]}let a=this.buf[this.pos++];if(e|=(15&a)<<28,t=(112&a)>>4,0==(128&a))return this.assertBounds(),[e,t];for(let a=3;a<=31;a+=7){let n=this.buf[this.pos++];if(t|=(127&n)<<a,0==(128&n))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function N(e,t,a){for(let n=0;n<28;n+=7){const s=e>>>n,r=!(s>>>7==0&&0==t),i=255&(r?128|s:s);if(a.push(i),!r)return}const n=e>>>28&15|(7&t)<<4,s=!(t>>3==0);if(a.push(255&(s?128|n:n)),s){for(let e=3;e<31;e+=7){const n=t>>>e,s=!(n>>>7==0),r=255&(s?128|n:n);if(a.push(r),!s)return}a.push(t>>>31&1)}}d["-".charCodeAt(0)]=h.indexOf("+"),d["_".charCodeAt(0)]=h.indexOf("/"),function(e){e.symbol=Symbol.for("protobuf-ts/unknown"),e.onRead=(a,n,s,r,i)=>{(t(n)?n[e.symbol]:n[e.symbol]=[]).push({no:s,wireType:r,data:i})},e.onWrite=(t,a,n)=>{for(let{no:t,wireType:s,data:r}of e.list(a))n.tag(t,s).raw(r)},e.list=(a,n)=>{if(t(a)){let t=a[e.symbol];return n?t.filter((e=>e.no==n)):t}return[]},e.last=(t,a)=>e.list(t,a).slice(-1)[0];const t=t=>t&&Array.isArray(t[e.symbol])}(m||(m={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(f||(f={}));const y=4294967296;function b(e){let t="-"==e[0];t&&(e=e.slice(1));const a=1e6;let n=0,s=0;function r(t,r){const i=Number(e.slice(t,r));s*=a,n=n*a+i,n>=y&&(s+=n/y|0,n%=y)}return r(-24,-18),r(-18,-12),r(-12,-6),r(-6),[t,n,s]}function T(e,t){if(t>>>0<=2097151)return""+(y*t+(e>>>0));let a=(e>>>24|t<<8)>>>0&16777215,n=t>>16&65535,s=(16777215&e)+6777216*a+6710656*n,r=a+8147497*n,i=2*n,o=1e7;function l(e,t){let a=e?String(e):"";return t?"0000000".slice(a.length)+a:a}return s>=o&&(r+=Math.floor(s/o),s%=o),r>=o&&(i+=Math.floor(r/o),r%=o),l(i,0)+l(r,i)+l(s,1)}function C(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let a=0;a<9;a++)t.push(127&e|128),e>>=7;t.push(1)}}function x(){let e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,0==(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let t=5;0!=(128&e)&&t<10;t++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}let w;function k(e){if(!e)throw new Error("BigInt unavailable, see https://github.com/timostamm/protobuf-ts/blob/v1.0.8/MANUAL.md#bigint-support")}!function(){const e=new DataView(new ArrayBuffer(8)),t=void 0!==globalThis.BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64;w=t?{MIN:BigInt("-9223372036854775808"),MAX:BigInt("9223372036854775807"),UMIN:BigInt("0"),UMAX:BigInt("18446744073709551615"),C:BigInt,V:e}:void 0}();const S=/^-?[0-9]+$/,I=4294967296,v=2147483648;class E{constructor(e,t){this.lo=0|e,this.hi=0|t}isZero(){return 0==this.lo&&0==this.hi}toNumber(){let e=this.hi*I+(this.lo>>>0);if(!Number.isSafeInteger(e))throw new Error("cannot convert to safe number");return e}}class O extends E{static from(e){if(w)switch(typeof e){case"string":if("0"==e)return this.ZERO;if(""==e)throw new Error("string is no integer");e=w.C(e);case"number":if(0===e)return this.ZERO;e=w.C(e);case"bigint":if(!e)return this.ZERO;if(e<w.UMIN)throw new Error("signed value for ulong");if(e>w.UMAX)throw new Error("ulong too large");return w.V.setBigUint64(0,e,!0),new O(w.V.getInt32(0,!0),w.V.getInt32(4,!0))}else switch(typeof e){case"string":if("0"==e)return this.ZERO;if(e=e.trim(),!S.test(e))throw new Error("string is no integer");let[t,a,n]=b(e);if(t)throw new Error("signed value for ulong");return new O(a,n);case"number":if(0==e)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");if(e<0)throw new Error("signed value for ulong");return new O(e,e/I)}throw new Error("unknown value "+typeof e)}toString(){return w?this.toBigInt().toString():T(this.lo,this.hi)}toBigInt(){return k(w),w.V.setInt32(0,this.lo,!0),w.V.setInt32(4,this.hi,!0),w.V.getBigUint64(0,!0)}}O.ZERO=new O(0,0);class B extends E{static from(e){if(w)switch(typeof e){case"string":if("0"==e)return this.ZERO;if(""==e)throw new Error("string is no integer");e=w.C(e);case"number":if(0===e)return this.ZERO;e=w.C(e);case"bigint":if(!e)return this.ZERO;if(e<w.MIN)throw new Error("signed long too small");if(e>w.MAX)throw new Error("signed long too large");return w.V.setBigInt64(0,e,!0),new B(w.V.getInt32(0,!0),w.V.getInt32(4,!0))}else switch(typeof e){case"string":if("0"==e)return this.ZERO;if(e=e.trim(),!S.test(e))throw new Error("string is no integer");let[t,a,n]=b(e);if(t){if(n>v||n==v&&0!=a)throw new Error("signed long too small")}else if(n>=v)throw new Error("signed long too large");let s=new B(a,n);return t?s.negate():s;case"number":if(0==e)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");return e>0?new B(e,e/I):new B(-e,-e/I).negate()}throw new Error("unknown value "+typeof e)}isNegative(){return 0!=(this.hi&v)}negate(){let e=~this.hi,t=this.lo;return t?t=1+~t:e+=1,new B(t,e)}toString(){if(w)return this.toBigInt().toString();if(this.isNegative()){let e=this.negate();return"-"+T(e.lo,e.hi)}return T(this.lo,this.hi)}toBigInt(){return k(w),w.V.setInt32(0,this.lo,!0),w.V.setInt32(4,this.hi,!0),w.V.getBigInt64(0,!0)}}B.ZERO=new B(0,0);const L={readUnknownField:!0,readerFactory:e=>new A(e)};class A{constructor(e,t){this.varint64=p,this.uint32=x,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!=t?t:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0})}tag(){let e=this.uint32(),t=e>>>3,a=7&e;if(t<=0||a<0||a>5)throw new Error("illegal tag: field no "+t+" wire type "+a);return[t,a]}skip(e){let t=this.pos;switch(e){case f.Varint:for(;128&this.buf[this.pos++];);break;case f.Bit64:this.pos+=4;case f.Bit32:this.pos+=4;break;case f.LengthDelimited:let t=this.uint32();this.pos+=t;break;case f.StartGroup:let a;for(;(a=this.tag()[1])!==f.EndGroup;)this.skip(a);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return new B(...this.varint64())}uint64(){return new O(...this.varint64())}sint64(){let[e,t]=this.varint64(),a=-(1&e);return e=(e>>>1|(1&t)<<31)^a,t=t>>>1^a,new B(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return new O(this.sfixed32(),this.sfixed32())}sfixed64(){return new B(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function $(e,t){if(!e)throw new Error(t)}function U(e){if("number"!=typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function j(e){if("number"!=typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function D(e){if("number"!=typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}const P={writeUnknownFields:!0,writerFactory:()=>new F};class F{constructor(e){this.stack=[],this.textEncoder=null!=e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),a=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],a),a+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(j(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return U(e),C(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){D(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){j(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){U(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return U(e),C(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),a=new DataView(t.buffer),n=B.from(e);return a.setInt32(0,n.lo,!0),a.setInt32(4,n.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),a=new DataView(t.buffer),n=O.from(e);return a.setInt32(0,n.lo,!0),a.setInt32(4,n.hi,!0),this.raw(t)}int64(e){let t=B.from(e);return N(t.lo,t.hi,this.buf),this}sint64(e){let t=B.from(e),a=t.hi>>31;return N(t.lo<<1^a,(t.hi<<1|t.lo>>>31)^a,this.buf),this}uint64(e){let t=O.from(e);return N(t.lo,t.hi,this.buf),this}}const V={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},R={ignoreUnknownFields:!1};const X=Symbol.for("protobuf-ts/message-type");function M(e){let t=!1;const a=[];for(let n=0;n<e.length;n++){let s=e.charAt(n);"_"==s?t=!0:/\d/.test(s)?(a.push(s),t=!0):t?(a.push(s.toUpperCase()),t=!1):0==n?a.push(s.toLowerCase()):a.push(s)}return a.join("")}var K,J,G;function q(e){var t,a,n,s;return e.localName=null!==(t=e.localName)&&void 0!==t?t:M(e.name),e.jsonName=null!==(a=e.jsonName)&&void 0!==a?a:M(e.name),e.repeat=null!==(n=e.repeat)&&void 0!==n?n:G.NO,e.opt=null!==(s=e.opt)&&void 0!==s?s:!e.repeat&&(!e.oneof&&"message"==e.kind),e}function H(e){if("object"!=typeof e||null===e||!e.hasOwnProperty("oneofKind"))return!1;switch(typeof e.oneofKind){case"string":return void 0!==e[e.oneofKind]&&2==Object.keys(e).length;case"undefined":return 1==Object.keys(e).length;default:return!1}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(K||(K={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING",e[e.NUMBER=2]="NUMBER"}(J||(J={})),function(e){e[e.NO=0]="NO",e[e.PACKED=1]="PACKED",e[e.UNPACKED=2]="UNPACKED"}(G||(G={}));class Z{constructor(e){var t;this.fields=null!==(t=e.fields)&&void 0!==t?t:[]}prepare(){if(this.data)return;const e=[],t=[],a=[];for(let n of this.fields)if(n.oneof)a.includes(n.oneof)||(a.push(n.oneof),e.push(n.oneof),t.push(n.oneof));else switch(t.push(n.localName),n.kind){case"scalar":case"enum":n.opt&&!n.repeat||e.push(n.localName);break;case"message":n.repeat&&e.push(n.localName);break;case"map":e.push(n.localName)}this.data={req:e,known:t,oneofs:Object.values(a)}}is(e,t,a=!1){if(t<0)return!0;if(null==e||"object"!=typeof e)return!1;this.prepare();let n=Object.keys(e),s=this.data;if(n.length<s.req.length||s.req.some((e=>!n.includes(e))))return!1;if(!a&&n.some((e=>!s.known.includes(e))))return!1;if(t<1)return!0;for(const n of s.oneofs){const s=e[n];if(!H(s))return!1;if(void 0===s.oneofKind)continue;const r=this.fields.find((e=>e.localName===s.oneofKind));if(!r)return!1;if(!this.field(s[s.oneofKind],r,a,t))return!1}for(const n of this.fields)if(void 0===n.oneof&&!this.field(e[n.localName],n,a,t))return!1;return!0}field(e,t,a,n){let s=t.repeat;switch(t.kind){case"scalar":return void 0===e?t.opt:s?this.scalars(e,t.T,n,t.L):this.scalar(e,t.T,t.L);case"enum":return void 0===e?t.opt:s?this.scalars(e,K.INT32,n):this.scalar(e,K.INT32);case"message":return void 0===e||(s?this.messages(e,t.T(),a,n):this.message(e,t.T(),a,n));case"map":if("object"!=typeof e||null===e)return!1;if(n<2)return!0;if(!this.mapKeys(e,t.K,n))return!1;switch(t.V.kind){case"scalar":return this.scalars(Object.values(e),t.V.T,n,t.V.L);case"enum":return this.scalars(Object.values(e),K.INT32,n);case"message":return this.messages(Object.values(e),t.V.T(),a,n)}}return!0}message(e,t,a,n){return a?t.isAssignable(e,n):t.is(e,n)}messages(e,t,a,n){if(!Array.isArray(e))return!1;if(n<2)return!0;if(a){for(let a=0;a<e.length&&a<n;a++)if(!t.isAssignable(e[a],n-1))return!1}else for(let a=0;a<e.length&&a<n;a++)if(!t.is(e[a],n-1))return!1;return!0}scalar(e,t,a){let n=typeof e;switch(t){case K.UINT64:case K.FIXED64:case K.INT64:case K.SFIXED64:case K.SINT64:switch(a){case J.BIGINT:return"bigint"==n;case J.NUMBER:return"number"==n&&!isNaN(e);default:return"string"==n}case K.BOOL:return"boolean"==n;case K.STRING:return"string"==n;case K.BYTES:return e instanceof Uint8Array;case K.DOUBLE:case K.FLOAT:return"number"==n&&!isNaN(e);default:return"number"==n&&Number.isInteger(e)}}scalars(e,t,a,n){if(!Array.isArray(e))return!1;if(a<2)return!0;if(Array.isArray(e))for(let s=0;s<e.length&&s<a;s++)if(!this.scalar(e[s],t,n))return!1;return!0}mapKeys(e,t,a){let n=Object.keys(e);switch(t){case K.INT32:case K.FIXED32:case K.SFIXED32:case K.SINT32:case K.UINT32:return this.scalars(n.slice(0,a).map((e=>parseInt(e))),t,a);case K.BOOL:return this.scalars(n.slice(0,a).map((e=>"true"==e||"false"!=e&&e)),t,a);default:return this.scalars(n,t,a,J.STRING)}}}function Y(e,t){switch(t){case J.BIGINT:return e.toBigInt();case J.NUMBER:return e.toNumber();default:return e.toString()}}class z{constructor(e){this.info=e}prepare(){var e;if(void 0===this.fMap){this.fMap={};const t=null!==(e=this.info.fields)&&void 0!==e?e:[];for(const e of t)this.fMap[e.name]=e,this.fMap[e.jsonName]=e,this.fMap[e.localName]=e}}assert(e,t,a){if(!e){let e=c(a);throw"number"!=e&&"boolean"!=e||(e=a.toString()),new Error(`Cannot parse JSON ${e} for ${this.info.typeName}#${t}`)}}read(e,t,a){this.prepare();const n=[];for(const[r,i]of Object.entries(e)){const e=this.fMap[r];if(!e){if(!a.ignoreUnknownFields)throw new Error(`Found unknown field while reading ${this.info.typeName} from JSON format. JSON key: ${r}`);continue}const o=e.localName;let l;if(e.oneof){if(null===i&&("enum"!==e.kind||"google.protobuf.NullValue"!==e.T()[0]))continue;if(n.includes(e.oneof))throw new Error(`Multiple members of the oneof group "${e.oneof}" of ${this.info.typeName} are present in JSON.`);n.push(e.oneof),l=t[e.oneof]={oneofKind:o}}else l=t;if("map"==e.kind){if(null===i)continue;this.assert(null!==(s=i)&&"object"==typeof s&&!Array.isArray(s),e.name,i);const t=l[o];for(const[n,s]of Object.entries(i)){let r;switch(this.assert(null!==s,e.name+" map value",null),e.V.kind){case"message":r=e.V.T().internalJsonRead(s,a);break;case"enum":if(r=this.enum(e.V.T(),s,e.name,a.ignoreUnknownFields),!1===r)continue;break;case"scalar":r=this.scalar(s,e.V.T,e.V.L,e.name)}this.assert(void 0!==r,e.name+" map value",s);let i=n;e.K==K.BOOL&&(i="true"==i||"false"!=i&&i),i=this.scalar(i,e.K,J.STRING,e.name).toString(),t[i]=r}}else if(e.repeat){if(null===i)continue;this.assert(Array.isArray(i),e.name,i);const t=l[o];for(const n of i){let s;switch(this.assert(null!==n,e.name,null),e.kind){case"message":s=e.T().internalJsonRead(n,a);break;case"enum":if(s=this.enum(e.T(),n,e.name,a.ignoreUnknownFields),!1===s)continue;break;case"scalar":s=this.scalar(n,e.T,e.L,e.name)}this.assert(void 0!==s,e.name,i),t.push(s)}}else switch(e.kind){case"message":if(null===i&&"google.protobuf.Value"!=e.T().typeName){this.assert(void 0===e.oneof,e.name+" (oneof member)",null);continue}l[o]=e.T().internalJsonRead(i,a,l[o]);break;case"enum":let t=this.enum(e.T(),i,e.name,a.ignoreUnknownFields);if(!1===t)continue;l[o]=t;break;case"scalar":l[o]=this.scalar(i,e.T,e.L,e.name)}}var s}enum(e,t,a,n){if("google.protobuf.NullValue"==e[0]&&$(null===t||"NULL_VALUE"===t,`Unable to parse field ${this.info.typeName}#${a}, enum ${e[0]} only accepts null.`),null===t)return 0;switch(typeof t){case"number":return $(Number.isInteger(t),`Unable to parse field ${this.info.typeName}#${a}, enum can only be integral number, got ${t}.`),t;case"string":let s=t;e[2]&&t.substring(0,e[2].length)===e[2]&&(s=t.substring(e[2].length));let r=e[1][s];return(void 0!==r||!n)&&($("number"==typeof r,`Unable to parse field ${this.info.typeName}#${a}, enum ${e[0]} has no value for "${t}".`),r)}$(!1,`Unable to parse field ${this.info.typeName}#${a}, cannot parse enum value from ${typeof t}".`)}scalar(e,t,a,n){let s;try{switch(t){case K.DOUBLE:case K.FLOAT:if(null===e)return 0;if("NaN"===e)return Number.NaN;if("Infinity"===e)return Number.POSITIVE_INFINITY;if("-Infinity"===e)return Number.NEGATIVE_INFINITY;if(""===e){s="empty string";break}if("string"==typeof e&&e.trim().length!==e.length){s="extra whitespace";break}if("string"!=typeof e&&"number"!=typeof e)break;let n=Number(e);if(Number.isNaN(n)){s="not a number";break}if(!Number.isFinite(n)){s="too large or small";break}return t==K.FLOAT&&D(n),n;case K.INT32:case K.FIXED32:case K.SFIXED32:case K.SINT32:case K.UINT32:if(null===e)return 0;let r;if("number"==typeof e?r=e:""===e?s="empty string":"string"==typeof e&&(e.trim().length!==e.length?s="extra whitespace":r=Number(e)),void 0===r)break;return t==K.UINT32?j(r):U(r),r;case K.INT64:case K.SFIXED64:case K.SINT64:if(null===e)return Y(B.ZERO,a);if("number"!=typeof e&&"string"!=typeof e)break;return Y(B.from(e),a);case K.FIXED64:case K.UINT64:if(null===e)return Y(O.ZERO,a);if("number"!=typeof e&&"string"!=typeof e)break;return Y(O.from(e),a);case K.BOOL:if(null===e)return!1;if("boolean"!=typeof e)break;return e;case K.STRING:if(null===e)return"";if("string"!=typeof e){s="extra whitespace";break}try{encodeURIComponent(e)}catch(s){s="invalid UTF8";break}return e;case K.BYTES:if(null===e||""===e)return new Uint8Array(0);if("string"!=typeof e)break;return function(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let a,n=new Uint8Array(t),s=0,r=0,i=0;for(let t=0;t<e.length;t++){if(a=d[e.charCodeAt(t)],void 0===a)switch(e[t]){case"=":r=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:i=a,r=1;break;case 1:n[s++]=i<<2|(48&a)>>4,i=a,r=2;break;case 2:n[s++]=(15&i)<<4|(60&a)>>2,i=a,r=3;break;case 3:n[s++]=(3&i)<<6|a,r=0}}if(1==r)throw Error("invalid base64 string.");return n.subarray(0,s)}(e)}}catch(e){s=e.message}this.assert(!1,n+(s?" - "+s:""),e)}}class _{constructor(e){var t;this.fields=null!==(t=e.fields)&&void 0!==t?t:[]}write(e,t){const a={},n=e;for(const e of this.fields){if(!e.oneof){let s=this.field(e,n[e.localName],t);void 0!==s&&(a[t.useProtoFieldName?e.name:e.jsonName]=s);continue}const s=n[e.oneof];if(s.oneofKind!==e.localName)continue;const r="scalar"==e.kind||"enum"==e.kind?Object.assign(Object.assign({},t),{emitDefaultValues:!0}):t;let i=this.field(e,s[e.localName],r);$(void 0!==i),a[t.useProtoFieldName?e.name:e.jsonName]=i}return a}field(e,t,a){let n;if("map"==e.kind){$("object"==typeof t&&null!==t);const s={};switch(e.V.kind){case"scalar":for(const[a,n]of Object.entries(t)){const t=this.scalar(e.V.T,n,e.name,!1,!0);$(void 0!==t),s[a.toString()]=t}break;case"message":const n=e.V.T();for(const[r,i]of Object.entries(t)){const t=this.message(n,i,e.name,a);$(void 0!==t),s[r.toString()]=t}break;case"enum":const r=e.V.T();for(const[n,i]of Object.entries(t)){$(void 0===i||"number"==typeof i);const t=this.enum(r,i,e.name,!1,!0,a.enumAsInteger);$(void 0!==t),s[n.toString()]=t}}(a.emitDefaultValues||Object.keys(s).length>0)&&(n=s)}else if(e.repeat){$(Array.isArray(t));const s=[];switch(e.kind){case"scalar":for(let a=0;a<t.length;a++){const n=this.scalar(e.T,t[a],e.name,e.opt,!0);$(void 0!==n),s.push(n)}break;case"enum":const n=e.T();for(let r=0;r<t.length;r++){$(void 0===t[r]||"number"==typeof t[r]);const i=this.enum(n,t[r],e.name,e.opt,!0,a.enumAsInteger);$(void 0!==i),s.push(i)}break;case"message":const r=e.T();for(let n=0;n<t.length;n++){const i=this.message(r,t[n],e.name,a);$(void 0!==i),s.push(i)}}(a.emitDefaultValues||s.length>0||a.emitDefaultValues)&&(n=s)}else switch(e.kind){case"scalar":n=this.scalar(e.T,t,e.name,e.opt,a.emitDefaultValues);break;case"enum":n=this.enum(e.T(),t,e.name,e.opt,a.emitDefaultValues,a.enumAsInteger);break;case"message":n=this.message(e.T(),t,e.name,a)}return n}enum(e,t,a,n,s,r){if("google.protobuf.NullValue"==e[0])return s||n?null:void 0;if(void 0!==t){if(0!==t||s||n)return $("number"==typeof t),$(Number.isInteger(t)),r||!e[1].hasOwnProperty(t)?t:e[2]?e[2]+e[1][t]:e[1][t]}else $(n)}message(e,t,a,n){return void 0===t?n.emitDefaultValues?null:void 0:e.internalJsonWrite(t,n)}scalar(e,t,a,n,s){if(void 0===t)return void $(n);const r=s||n;switch(e){case K.INT32:case K.SFIXED32:case K.SINT32:return 0===t?r?0:void 0:(U(t),t);case K.FIXED32:case K.UINT32:return 0===t?r?0:void 0:(j(t),t);case K.FLOAT:D(t);case K.DOUBLE:return 0===t?r?0:void 0:($("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t);case K.STRING:return""===t?r?"":void 0:($("string"==typeof t),t);case K.BOOL:return!1===t?!r&&void 0:($("boolean"==typeof t),t);case K.UINT64:case K.FIXED64:$("number"==typeof t||"string"==typeof t||"bigint"==typeof t);let e=O.from(t);if(e.isZero()&&!r)return;return e.toString();case K.INT64:case K.SFIXED64:case K.SINT64:$("number"==typeof t||"string"==typeof t||"bigint"==typeof t);let a=B.from(t);if(a.isZero()&&!r)return;return a.toString();case K.BYTES:return $(t instanceof Uint8Array),t.byteLength?function(e){let t,a="",n=0,s=0;for(let r=0;r<e.length;r++)switch(t=e[r],n){case 0:a+=h[t>>2],s=(3&t)<<4,n=1;break;case 1:a+=h[s|t>>4],s=(15&t)<<2,n=2;break;case 2:a+=h[s|t>>6],a+=h[63&t],n=0}return n&&(a+=h[s],a+="=",1==n&&(a+="=")),a}(t):r?"":void 0}}}function W(e,t=J.STRING){switch(e){case K.BOOL:return!1;case K.UINT64:case K.FIXED64:return Y(O.ZERO,t);case K.INT64:case K.SFIXED64:case K.SINT64:return Y(B.ZERO,t);case K.DOUBLE:case K.FLOAT:return 0;case K.BYTES:return new Uint8Array(0);case K.STRING:return"";default:return 0}}class Q{constructor(e){this.info=e}prepare(){var e;if(!this.fieldNoToField){const t=null!==(e=this.info.fields)&&void 0!==e?e:[];this.fieldNoToField=new Map(t.map((e=>[e.no,e])))}}read(e,t,a,n){this.prepare();const s=void 0===n?e.len:e.pos+n;for(;e.pos<s;){const[n,s]=e.tag(),r=this.fieldNoToField.get(n);if(!r){let r=a.readUnknownField;if("throw"==r)throw new Error(`Unknown field ${n} (wire type ${s}) for ${this.info.typeName}`);let i=e.skip(s);!1!==r&&(!0===r?m.onRead:r)(this.info.typeName,t,n,s,i);continue}let i=t,o=r.repeat,l=r.localName;switch(r.oneof&&(i=i[r.oneof],i.oneofKind!==l&&(i=t[r.oneof]={oneofKind:l})),r.kind){case"scalar":case"enum":let t="enum"==r.kind?K.INT32:r.T,n="scalar"==r.kind?r.L:void 0;if(o){let a=i[l];if(s==f.LengthDelimited&&t!=K.STRING&&t!=K.BYTES){let s=e.uint32()+e.pos;for(;e.pos<s;)a.push(this.scalar(e,t,n))}else a.push(this.scalar(e,t,n))}else i[l]=this.scalar(e,t,n);break;case"message":if(o){let t=i[l],n=r.T().internalBinaryRead(e,e.uint32(),a);t.push(n)}else i[l]=r.T().internalBinaryRead(e,e.uint32(),a,i[l]);break;case"map":let[u,g]=this.mapEntry(r,e,a);i[l][u]=g}}}mapEntry(e,t,a){let n,s,r=t.uint32(),i=t.pos+r;for(;t.pos<i;){let[r,i]=t.tag();switch(r){case 1:n=e.K==K.BOOL?t.bool().toString():this.scalar(t,e.K,J.STRING);break;case 2:switch(e.V.kind){case"scalar":s=this.scalar(t,e.V.T,e.V.L);break;case"enum":s=t.int32();break;case"message":s=e.V.T().internalBinaryRead(t,t.uint32(),a)}break;default:throw new Error(`Unknown field ${r} (wire type ${i}) in map entry for ${this.info.typeName}#${e.name}`)}}if(void 0===n){let t=W(e.K);n=e.K==K.BOOL?t.toString():t}if(void 0===s)switch(e.V.kind){case"scalar":s=W(e.V.T,e.V.L);break;case"enum":s=0;break;case"message":s=e.V.T().create()}return[n,s]}scalar(e,t,a){switch(t){case K.INT32:return e.int32();case K.STRING:return e.string();case K.BOOL:return e.bool();case K.DOUBLE:return e.double();case K.FLOAT:return e.float();case K.INT64:return Y(e.int64(),a);case K.UINT64:return Y(e.uint64(),a);case K.FIXED64:return Y(e.fixed64(),a);case K.FIXED32:return e.fixed32();case K.BYTES:return e.bytes();case K.UINT32:return e.uint32();case K.SFIXED32:return e.sfixed32();case K.SFIXED64:return Y(e.sfixed64(),a);case K.SINT32:return e.sint32();case K.SINT64:return Y(e.sint64(),a)}}}class ee{constructor(e){this.info=e}prepare(){if(!this.fields){const e=this.info.fields?this.info.fields.concat():[];this.fields=e.sort(((e,t)=>e.no-t.no))}}write(e,t,a){this.prepare();for(const n of this.fields){let s,r,i=n.repeat,o=n.localName;if(n.oneof){const t=e[n.oneof];if(t.oneofKind!==o)continue;s=t[o],r=!0}else s=e[o],r=!1;switch(n.kind){case"scalar":case"enum":let e="enum"==n.kind?K.INT32:n.T;if(i)if($(Array.isArray(s)),i==G.PACKED)this.packed(t,e,n.no,s);else for(const a of s)this.scalar(t,e,n.no,a,!0);else void 0===s?$(n.opt):this.scalar(t,e,n.no,s,r||n.opt);break;case"message":if(i){$(Array.isArray(s));for(const e of s)this.message(t,a,n.T(),n.no,e)}else this.message(t,a,n.T(),n.no,s);break;case"map":$("object"==typeof s&&null!==s);for(const[e,r]of Object.entries(s))this.mapEntry(t,a,n,e,r)}}let n=a.writeUnknownFields;!1!==n&&(!0===n?m.onWrite:n)(this.info.typeName,e,t)}mapEntry(e,t,a,n,s){e.tag(a.no,f.LengthDelimited),e.fork();let r=n;switch(a.K){case K.INT32:case K.FIXED32:case K.UINT32:case K.SFIXED32:case K.SINT32:r=Number.parseInt(n);break;case K.BOOL:$("true"==n||"false"==n),r="true"==n}switch(this.scalar(e,a.K,1,r,!0),a.V.kind){case"scalar":this.scalar(e,a.V.T,2,s,!0);break;case"enum":this.scalar(e,K.INT32,2,s,!0);break;case"message":this.message(e,t,a.V.T(),2,s)}e.join()}message(e,t,a,n,s){void 0!==s&&(a.internalBinaryWrite(s,e.tag(n,f.LengthDelimited).fork(),t),e.join())}scalar(e,t,a,n,s){let[r,i,o]=this.scalarInfo(t,n);o&&!s||(e.tag(a,r),e[i](n))}packed(e,t,a,n){if(!n.length)return;$(t!==K.BYTES&&t!==K.STRING),e.tag(a,f.LengthDelimited),e.fork();let[,s]=this.scalarInfo(t);for(let t=0;t<n.length;t++)e[s](n[t]);e.join()}scalarInfo(e,t){let a,n=f.Varint,s=void 0===t,r=0===t;switch(e){case K.INT32:a="int32";break;case K.STRING:r=s||!t.length,n=f.LengthDelimited,a="string";break;case K.BOOL:r=!1===t,a="bool";break;case K.UINT32:a="uint32";break;case K.DOUBLE:n=f.Bit64,a="double";break;case K.FLOAT:n=f.Bit32,a="float";break;case K.INT64:r=s||B.from(t).isZero(),a="int64";break;case K.UINT64:r=s||O.from(t).isZero(),a="uint64";break;case K.FIXED64:r=s||O.from(t).isZero(),n=f.Bit64,a="fixed64";break;case K.BYTES:r=s||!t.byteLength,n=f.LengthDelimited,a="bytes";break;case K.FIXED32:n=f.Bit32,a="fixed32";break;case K.SFIXED32:n=f.Bit32,a="sfixed32";break;case K.SFIXED64:r=s||B.from(t).isZero(),n=f.Bit64,a="sfixed64";break;case K.SINT32:a="sint32";break;case K.SINT64:r=s||B.from(t).isZero(),a="sint64"}return[n,a,s||r]}}function te(e,t,a){let n,s,r=a;for(let a of e.fields){let e=a.localName;if(a.oneof){const i=r[a.oneof];if(null==(null==i?void 0:i.oneofKind))continue;if(n=i[e],s=t[a.oneof],s.oneofKind=i.oneofKind,null==n){delete s[e];continue}}else if(n=r[e],s=t,null==n)continue;switch(a.repeat&&(s[e].length=n.length),a.kind){case"scalar":case"enum":if(a.repeat)for(let t=0;t<n.length;t++)s[e][t]=n[t];else s[e]=n;break;case"message":let t=a.T();if(a.repeat)for(let a=0;a<n.length;a++)s[e][a]=t.create(n[a]);else void 0===s[e]?s[e]=t.create(n):t.mergePartial(s[e],n);break;case"map":switch(a.V.kind){case"scalar":case"enum":Object.assign(s[e],n);break;case"message":let t=a.V.T();for(let a of Object.keys(n))s[e][a]=t.create(n[a])}}}}const ae=Object.values;function ne(e,t,a){if(t===a)return!0;if(e!==K.BYTES)return!1;let n=t,s=a;if(n.length!==s.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!=s[e])return!1;return!0}function se(e,t,a){if(t.length!==a.length)return!1;for(let n=0;n<t.length;n++)if(!ne(e,t[n],a[n]))return!1;return!0}function re(e,t,a){if(t.length!==a.length)return!1;for(let n=0;n<t.length;n++)if(!e.equals(t[n],a[n]))return!1;return!0}class ie{constructor(e,t,a){this.defaultCheckDepth=16,this.typeName=e,this.fields=t.map(q),this.options=null!=a?a:{},this.messagePrototype=Object.defineProperty({},X,{value:this}),this.refTypeCheck=new Z(this),this.refJsonReader=new z(this),this.refJsonWriter=new _(this),this.refBinReader=new Q(this),this.refBinWriter=new ee(this)}create(e){let t=function(e){const t=e.messagePrototype?Object.create(e.messagePrototype):Object.defineProperty({},X,{value:e});for(let a of e.fields){let e=a.localName;if(!a.opt)if(a.oneof)t[a.oneof]={oneofKind:void 0};else if(a.repeat)t[e]=[];else switch(a.kind){case"scalar":t[e]=W(a.T,a.L);break;case"enum":t[e]=0;break;case"map":t[e]={}}}return t}(this);return void 0!==e&&te(this,t,e),t}clone(e){let t=this.create();return te(this,t,e),t}equals(e,t){return function(e,t,a){if(t===a)return!0;if(!t||!a)return!1;for(let n of e.fields){let e=n.localName,s=n.oneof?t[n.oneof][e]:t[e],r=n.oneof?a[n.oneof][e]:a[e];switch(n.kind){case"enum":case"scalar":let e="enum"==n.kind?K.INT32:n.T;if(!(n.repeat?se(e,s,r):ne(e,s,r)))return!1;break;case"map":if(!("message"==n.V.kind?re(n.V.T(),ae(s),ae(r)):se("enum"==n.V.kind?K.INT32:n.V.T,ae(s),ae(r))))return!1;break;case"message":let t=n.T();if(!(n.repeat?re(t,s,r):t.equals(s,r)))return!1}}return!0}(this,e,t)}is(e,t=this.defaultCheckDepth){return this.refTypeCheck.is(e,t,!1)}isAssignable(e,t=this.defaultCheckDepth){return this.refTypeCheck.is(e,t,!0)}mergePartial(e,t){te(this,e,t)}fromBinary(e,t){let a=function(e){return e?Object.assign(Object.assign({},L),e):L}(t);return this.internalBinaryRead(a.readerFactory(e),e.byteLength,a)}fromJson(e,t){return this.internalJsonRead(e,function(e){return e?Object.assign(Object.assign({},R),e):R}(t))}fromJsonString(e,t){let a=JSON.parse(e);return this.fromJson(a,t)}toJson(e,t){return this.internalJsonWrite(e,function(e){return e?Object.assign(Object.assign({},V),e):V}(t))}toJsonString(e,t){var a;let n=this.toJson(e,t);return JSON.stringify(n,null,null!==(a=null==t?void 0:t.prettySpaces)&&void 0!==a?a:0)}toBinary(e,t){let a=function(e){return e?Object.assign(Object.assign({},P),e):P}(t);return this.internalBinaryWrite(e,a.writerFactory(),a).finish()}internalJsonRead(e,t,a){if(null!==e&&"object"==typeof e&&!Array.isArray(e)){let n=null!=a?a:this.create();return this.refJsonReader.read(e,n,t),n}throw new Error(`Unable to parse message ${this.typeName} from JSON ${c(e)}.`)}internalJsonWrite(e,t){return this.refJsonWriter.write(e,t)}internalBinaryWrite(e,t,a){return this.refBinWriter.write(e,t,a),t}internalBinaryRead(e,t,a,n){let s=null!=n?n:this.create();return this.refBinReader.read(e,s,a,t),s}}const oe=new a("🍿 DualSubs: ▶ YouTube v1.4.0(4) request");let le;const ue=new URL($request.url);oe.log(`⚠ url: ${ue.toJSON()}`,"");const ge=$request.method,ce=ue.hostname,he=ue.pathname;oe.log(`⚠ METHOD: ${ge}, HOST: ${ce}, PATH: ${he}`,"");const de=($request.headers?.["Content-Type"]??$request.headers?.["content-type"])?.split(";")?.[0];oe.log(`⚠ FORMAT: ${de}`,""),(async()=>{const{Settings:a,Caches:n,Configs:s}=g("DualSubs","YouTube",u);switch(oe.log(`⚠ Settings.Switch: ${a?.Switch}`,""),a.Switch){case!0:default:const s=ue.searchParams.get("subtype")??a.Type,r=[ue.searchParams.get("lang")?.toUpperCase?.()??a.Languages[0],(ue.searchParams.get("tlang")??n?.tlang)?.toUpperCase?.()??a.Languages[1]];oe.log(`⚠ Type: ${s}, Languages: ${r}`,"");let i={};switch(ge){case"POST":case"PUT":case"PATCH":case"DELETE":switch(de){case void 0:case"application/x-www-form-urlencoded":case"text/plain":default:case"application/x-mpegURL":case"application/x-mpegurl":case"application/vnd.apple.mpegurl":case"audio/mpegurl":case"text/xml":case"text/html":case"text/plist":case"application/xml":case"application/plist":case"application/x-plist":case"text/vtt":case"application/vtt":break;case"text/json":case"application/json":switch(i=JSON.parse($request.body??"{}"),he){case"/youtubei/v1/player":i?.playbackContext&&(oe.log("⚠ playbackContext",""),i?.playbackContext.contentPlaybackContext&&(i.playbackContext.contentPlaybackContext.autoCaptionsDefaultOn=!0));break;case"/youtubei/v1/browse":i?.browseId?.startsWith?.("MPLYt_")&&ue.searchParams.set("subtype","Translate")}$request.body=JSON.stringify(i);break;case"application/protobuf":case"application/x-protobuf":case"application/vnd.google.protobuf":case"application/grpc":case"application/grpc+proto":case"application/octet-stream":let t=oe.isQuanX()?new Uint8Array($request.bodyBytes??[]):$request.body??new Uint8Array;switch(de){case"application/protobuf":case"application/x-protobuf":case"application/vnd.google.protobuf":class n extends ie{constructor(){super("Context",[{no:1,name:"client",kind:"message",T:()=>o},{no:9,name:"adSignalsInfo",kind:"message",T:()=>u}])}}const s=new n;class r extends ie{constructor(){super("Client",[{no:1,name:"hl",kind:"scalar",opt:!0,T:9},{no:2,name:"gl",kind:"scalar",opt:!0,T:9},{no:12,name:"deviceMake",kind:"scalar",T:9},{no:13,name:"deviceModel",kind:"scalar",T:9},{no:16,name:"clientName",kind:"scalar",T:5},{no:17,name:"clientVersion",kind:"scalar",T:9},{no:18,name:"osName",kind:"scalar",T:9},{no:19,name:"osVersion",kind:"scalar",T:9},{no:80,name:"timeZone",kind:"scalar",T:9}])}}const o=new r;class l extends ie{constructor(){super("AdSignalsInfo",[{no:1,name:"params",kind:"map",K:9,V:{kind:"scalar",T:9}}])}}const u=new l;switch(he){case"/youtubei/v1/player":class n extends ie{constructor(){super("Player",[{no:1,name:"context",kind:"message",T:()=>s},{no:2,name:"videoId",kind:"scalar",T:9},{no:4,name:"playbackContext",kind:"message",T:()=>l}])}}const r=new n;class o extends ie{constructor(){super("PlaybackContext",[{no:1,name:"contentPlaybackContext",kind:"message",T:()=>g}])}}const l=new o;class u extends ie{constructor(){super("ContentPlaybackContext",[{no:4,name:"id4",kind:"scalar",opt:!0,T:5},{no:6,name:"id6",kind:"scalar",opt:!0,T:5},{no:8,name:"id8",kind:"scalar",opt:!0,T:5},{no:9,name:"id9",kind:"scalar",opt:!0,T:5}])}}const g=new u;i=r.fromBinary(t),i?.playbackContext&&(oe.log("⚠ playbackContext",""),i?.playbackContext.contentPlaybackContext&&(i.playbackContext.contentPlaybackContext.id4=1,i.playbackContext.contentPlaybackContext.id6=1,i.playbackContext.contentPlaybackContext.id8=1,i.playbackContext.contentPlaybackContext.id9=1)),t=r.toBinary(i);break;case"/youtubei/v1/browse":class c extends ie{constructor(){super("Browse",[{no:1,name:"context",kind:"message",T:()=>s},{no:2,name:"browseId",kind:"scalar",opt:!0,T:9}])}}const h=new c;i=h.fromBinary(t),i?.browseId?.startsWith?.("MPLYt_")&&(a.Types.includes("Translate")?e.set(URL,"query.subtype","Translate"):a.Types.includes("External")&&e.set(URL,"query.subtype","External")),t=h.toBinary(i)}}$request.body=t}case"GET":switch(ce){case"www.youtube.com":case"m.youtube.com":if("/api/timedtext"===he){const e=ue.searchParams.get("v"),s=ue.searchParams.get("kind"),r=ue.searchParams.get("lang"),i=ue.searchParams.get("tlang");if(oe.log(`⚠ v: ${e}, kind: ${s}, lang: ${r}, tlang: ${i}`,""),!i)switch(oe.log("⚠ 翻译语言：未指定",""),e&&r&&(n.Playlists.Subtitle.set(e,r),n.Playlists.Subtitle=function(e,t=100){return console.log(`☑️ Set Cache, cacheSize: ${t}`,""),e=(e=Array.from(e||[])).slice(-t),console.log("✅ Set Cache",""),e}(n?.Playlists.Subtitle,a.CacheSize),t.setItem("@DualSubs.Composite.Caches.Playlists.Subtitle",n.Playlists.Subtitle)),a.AutoCC){case!0:default:oe.log("⚠ 自动翻译字幕：开启",""),n.tlang&&n.tlang!==r&&ue.searchParams.set("tlang",n.tlang);break;case!1:oe.log("⚠ 自动翻译字幕：关闭","")}if(ue.searchParams.get("tlang"))switch(oe.log("⚠ 翻译语言：已指定",""),n.tlang=ue.searchParams.get("tlang"),t.setItem("@DualSubs.YouTube.Caches.tlang",n.tlang),a.Type){case"Composite":case"Official":default:oe.log("⚠ 官方字幕：合成器",""),r?.split?.(/[-_]/)?.[0]===ue.searchParams.get("tlang")?.split?.(/[-_]/)?.[0]&&(a.ShowOnly=!0),a.ShowOnly||ue.searchParams.set("subtype","Official");break;case"Translate":oe.log("⚠ 翻译字幕：翻译器",""),ue.searchParams.delete("tlang"),ue.searchParams.set("subtype","Translate");break;case"External":oe.log("⚠ 外部字幕：外部源",""),ue.searchParams.delete("tlang"),ue.searchParams.set("subtype","External")}}}}$request.url=ue.toString(),oe.log("🚧 调试信息",`$request.url: ${$request.url}`,"");case!1:}})().catch((e=>oe.logErr(e))).finally((()=>{if(void 0===le)oe.done($request);else oe.isQuanX()?(le.status||(le.status="HTTP/1.1 200 OK"),delete le.headers?.["Content-Length"],delete le.headers?.["content-length"],delete le.headers?.["Transfer-Encoding"],oe.done(le)):oe.done({response:le})}));
